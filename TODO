Add some test
Windows support again
Cosmetic change src

